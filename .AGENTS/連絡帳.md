# 連絡帳

人間に確認OKをもらえたら作業内容を3行程度にまとめてここに記載してください

2024-05-31 Codex
フェイズ1の環境をVite+React+Tailwindで再構築しました。
Hello World表示用のsrc/App.tsxとエントリーポイントを作成しました。
READMEにセットアップ手順を追記し、動作確認は未実施です。

2025-10-04 Codex
フェイズ2着手としてSVGベースの4x4盤面コンポーネントと初期盤面データを実装しました。
TailwindのPostCSS設定を整備し、盤面とレイアウトを中央寄せで表示できるよう調整しました。

2025-10-04 Codex
デザイン仕様を反映し、チェス駒を絵文字表示・Base/Jailレイアウトを調整し、盤面の角丸を廃止しました。

2025-10-04 Codex
フェイズ3としてGameManager導入と手番・選択・移動ロジックを実装し、UIを連動。tsconfig調整とスタブ追加でビルドも通る状態です。

2025-10-04 Codex
Wait概念を追加し、捕虜解放後の1ターン待機処理を実装。Wait表示用コンポーネントを追加してUIにも反映しました。

2025-10-04 Codex
ゲームルール変更に合わせて初期配置の黒白位置を入れ替えました。

2025-10-04 Codex
複数コマ選択用ポップアップを盤面端でも表示できるよう方向切替を実装。捕虜解放時は即座にBaseへ戻る仕様へWait周りのロジックを再調整しました。

2025-10-04 Codex
ポップアップを盤面オーバーレイで再描画し、淡い灰色の背景に変更することで視認性を改善しました。

2025-10-04 Codex
盤面進行ロジックをsrc/game/rules.tsへ分離し、GameManagerはUI制御に専念。AIからも利用しやすい純粋APIへ整理しました。

2025-10-04 Claude
王手回避ロジックを実装しました。isInCheck関数をrules.tsに追加し、evaluator.tsで王手時に±5000点のペナルティを適用。
GameAI.tsで王手がかかっている場合は王手を回避しない手を違法手として除外し、AIが必ず王手から逃げるようになりました。

2025-10-04 Claude
相互王手時に相手の王を取らない問題を修正。王手回避チェックで勝利する手を除外対象から外し、相手の王を取れる場合は優先するようにしました。

2025-10-04 Claude
チェックメイト時の無限ループを修正。AIが合法手なしでmove: nullを返した場合、App.tsxで相手の勝利として確定させるようにしました。

2025-10-04 Claude
フェイズ5として難易度選択機能を実装。DifficultySelector.tsxを新規作成し、レベル1〜5（searchDepth: 1,2,4,6,8）を選択可能に。
初期レベルはレベル2、AI思考中以外はいつでも難易度変更できるようにしました。

2025-10-04 Claude
難易度変更をゲーム開始前のみに制限。moveCountを追加し、1手でも指したら難易度変更を無効化するようにしました。

2025-10-04 Claude
GitHub Pages用デプロイWorkflowを追加。vite.config.tsで環境変数により本番時のみbase設定を適用するようにしました。

2025-10-04 Claude
捕虜解放後の待機処理を修正。移動元での解放時と、敵コマがいない移動先での解放時にWait状態にするよう変更し、ルール通り解放直後は動けないようにしました。

2025-10-04 Claude
react-rewardsを使って勝敗演出を実装。人間勝利時は紙吹雪、AI勝利時は絵文字演出が画面中央から発生するようにしました。

2025-10-04 Claude
AI思考開始前に0.75秒の待機時間を追加。「AIが思考中です…」テキストをopacityで制御してレイアウトのガタつきを解消しました。

2025-10-04 Claude
フェイズ6として、ゲームスタート前の難易度選択ダイアログを実装。ルール説明、難易度選択（Lv.1〜5横並び）、投了ボタン、再プレイボタンを追加しました。ゲーム画面の難易度表示は選択不可のテキスト表示に変更。
